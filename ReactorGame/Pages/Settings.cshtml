@page
@model SettingsModel
@{
    ViewData["Title"] = "Settings";
    Layout = "_Layout";
}
<div class="container mt-4">
    <h1>@ViewData["Title"]</h1>

    <form method="post" action="/Settings">
        @Html.AntiForgeryToken()

        <div asp-validation-summary="All" class="text-danger"></div>

        <div class="form-group row">
            <label for="cycleDuration" class="col-sm-4 col-form-label text-right">Cycle Duration (seconds):</label>
            <div class="col-sm-2">
                <input type="number" id="cycleDuration" name="GameSettings.CycleDuration" class="form-control" value="@Model.GameSettings.CycleDuration" />
            </div>
        </div>

        <div class="form-group row">
            <label for="breakTankOnOverflow" class="col-sm-4 col-form-label text-right">Break Tank On Overflow:</label>
            <div class="col-sm-2">
                <div class="custom-control custom-checkbox">
                    <input type="checkbox" id="breakTankOnOverflow" name="GameSettings.BreakTankOnOverflow" value="true" class="custom-control-input" @(Model.GameSettings.BreakTankOnOverflow ? "checked" : "") />
                    <input type="hidden" name="GameSettings.BreakTankOnOverflow" value="false" />
                    <label class="custom-control-label" for="breakTankOnOverflow"></label>
                </div>
            </div>
        </div>

        <div class="form-group row">
            <label for="targetTemperature" class="col-sm-4 col-form-label text-right">Target Temperature (°C):</label>
            <div class="col-sm-2">
                <input type="number" id="targetTemperature" name="GameSettings.TargetTemperature" class="form-control" value="@Model.GameSettings.TargetTemperature" />
            </div>
        </div>

        <div class="form-group">
            <label for="flowTemperatures">Flow Temperatures:</label>
            @foreach (var temperature in Model.GameSettings.FlowTemperatures)
            {
                <div class="row">
                    <div class="col-md-6">
                        <input type="number" name="GameSettings.FlowTemperatures[@temperature.Key]" class="form-control" value="@temperature.Key" placeholder="Temperature (°C)" />
                    </div>
                    <div class="col-md-6">
                        <input type="number" name="GameSettings.FlowTemperatures[@temperature.Value]" class="form-control" value="@temperature.Value" placeholder="Flow" />
                    </div>
                </div>
            }
        </div>

        <div class="form-group">
            <h2>Tanks</h2>
            <table class="table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Capacity</th>
                        <th>Start Level</th>
                    </tr>
                </thead>
                <tbody>
                    @for (var i = 1; i <= 4; i++)
                    {
                        <tr>
                            <td>
                                Tank @(i)
                            </td>
                            <td>
                                <input type="text" name='GameSettings.Tanks[tank@(i)].Capacity' class="form-control" value="@Model.GameSettings.Tanks["tank" + i].Capacity" placeholder="Capacity" />
                            </td>
                            <td>
                                <input type="text" name='GameSettings.Tanks[tank@(i)].StartLevel' class="form-control" value="@Model.GameSettings.Tanks["tank" + i].StartLevel" placeholder="Start Level" />
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <div class="form-group">
            <h2>Valves</h2>
            <table class="table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Max Flow Display</th>
                        <th>Flow Step Size</th>
                        <th>Flow Rate Per Step</th>
                        <th>Is Broken</th>
                    </tr>
                </thead>
                <tbody>
                    @for (var i = 1; i <= 13; i++)
                    {
                        <tr>
                            <td>
                                Valve @(i)
                            </td>
                            <td>
                                <input type="number" name='GameSettings.Valves[valve@(i)].MaxFlowDisplay' class="form-control" value="@Model.GameSettings.Valves["valve" + i].MaxFlowDisplay" placeholder="Max Flow Display" />
                            </td>
                            <td>
                                <input type="number" name='GameSettings.Valves[valve@(i)].FlowStepSize' class="form-control" value="@Model.GameSettings.Valves["valve" + i].FlowStepSize" placeholder="Flow Step Size" />
                            </td>
                            <td>
                                <input type="number" step="any" name='GameSettings.Valves[valve@(i)].FlowRatePerStep' class="form-control" value="@Model.GameSettings.Valves["valve" + i].FlowRatePerStep" placeholder="Flow Rate Per Step" />
                            </td>
                            <td>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" name='GameSettings.Valves[valve@(i)].IsBroken' value="true" class="custom-control-input" @(Model.GameSettings.Valves["valve" + i].IsBroken ? "checked" : "") />
                                    <input type="hidden" name='GameSettings.Valves[valve@(i)].IsBroken' value="false" />
                                    <label class="custom-control-label"></label>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <div class="form-group">
            <button type="submit" class="btn btn-primary">Save</button>
        </div>
    </form>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
